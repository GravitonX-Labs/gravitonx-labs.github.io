<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FocusGuard Pro | GravitonX</title>
    <link rel="icon" href="../appicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- FONTS & LIBS -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.0/vanilla-tilt.min.js"></script>

    <!-- LINK TO MAIN CSS -->
    <link rel="stylesheet" href="../style.css">

    <style>
        /* PAGE SPECIFIC SAFETY STYLES */
        
        /* Ensure Cursor is ALWAYS on top of the download overlay */
        .cursor-dot, .cursor-outline {
            z-index: 999999 !important; 
        }

        /* Download Overlay Cursor Visibility */
        #download-overlay {
            cursor: default !important;
        }

        /* Mobile Adjustments */
        @media (max-width: 900px) {
            .fg-hero { flex-direction: column !important; text-align: center; gap: 30px !important; }
            .fg-hero h1 { font-size: 2.8rem !important; }
            .typing-container { justify-content: center !important; }
            .grid-3 { grid-template-columns: 1fr !important; padding: 0 20px; }
            .success-card { padding: 30px 20px; }
        }

        /* Typewriter Color Override */
        .typing-text { color: var(--accent); font-family: 'JetBrains Mono', monospace; font-weight: bold; font-size: 1.5rem; }
    </style>
</head>
<body>
    <!-- UTILS -->
    <div class="noise-overlay"></div>
    <div class="page-transition"></div>
    <div class="cursor-dot"></div> <div class="cursor-outline"></div> 
    <canvas id="neural-canvas"></canvas>

    <!-- NAV -->
    <nav>
        <a href="../index.html" class="logo"><img src="../appicon.png"> FocusGuard Pro</a>
        <div class="nav-links">
            <a href="../index.html"> < Back to Labs</a>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <section class="section fg-hero" style="display:flex; align-items:center; gap:50px; min-height: 90vh;">
        <div style="flex:1;" data-aos="fade-right">
            <h1 style="font-size:4rem; line-height:1;">Regain <span class="text-grad">Focus.</span></h1>
            
            <div class="typing-container" style="justify-content: flex-start; margin-top: 15px; display:flex; align-items:center;">
                <span id="fg-typewriter" class="typing-text"></span>
            </div>

            <p style="color:#ccc; font-size:1.2rem; margin-bottom: 30px; margin-top: 15px;">
                Aggressively terminate distractions using the <b>Verlet-X</b> logic engine. Experience flow state like never before.
            </p>

            <div style="display:flex; gap:15px; flex-wrap:wrap;">
                
                <!-- APP DOWNLOAD BUTTON (Triggers Overlay) -->
                <!-- Added no-transition to prevent black screen -->
                <button onclick="startDownloadFlow()" id="dl-btn-real" class="btn-glow no-transition">
                    <i class="fa-brands fa-windows"></i> Download App v12.0
                </button>
                
                <!-- MANUAL DOWNLOAD BUTTON (Direct File Link) -->
                <!-- 'download' attribute forces download, 'no-transition' stops animation script -->
                <a href="../FocusGuard_Pro_User_Manual.pdf" download class="btn-glow no-transition" style="background:rgba(255,255,255,0.1); box-shadow:none; text-decoration:none;">
                    <i class="fa-solid fa-file-arrow-down"></i> Download Manual
                </a>

            </div>
            <p style="margin-top:10px; color:#666; font-size:0.8rem;">* No Admin Rights Required</p>
        </div>
        
        <div style="flex:1;" data-aos="zoom-in">
            <img src="../dashboard.png" style="width:100%; border-radius:20px; border:1px solid rgba(255,255,255,0.2); box-shadow:0 30px 80px rgba(93,95,239,0.3);" data-tilt>
        </div>
    </section>

    <!-- FEATURES -->
    <section class="section" style="padding-top:0;">
        <h2 style="text-align:center; margin-bottom:50px; font-size:2.5rem;" data-aos="fade-up">System Capabilities</h2>
        <div class="grid-3">
             <div class="glass-card" data-aos="fade-up"><i class="fa-solid fa-ban" style="font-size:2rem; color:var(--accent); margin-bottom:15px;"></i><h3>Strict Protocol</h3><p>Aggressively terminates distracted apps instantly.</p></div>
             <div class="glass-card" data-aos="fade-up" data-aos-delay="100"><i class="fa-solid fa-ghost" style="font-size:2rem; color:var(--accent); margin-bottom:15px;"></i><h3>Ghost Mode</h3><p>Runs silently in the system tray with near-zero CPU impact.</p></div>
             <div class="glass-card" data-aos="fade-up" data-aos-delay="200"><i class="fa-solid fa-wand-magic-sparkles" style="font-size:2rem; color:var(--accent); margin-bottom:15px;"></i><h3>GravitonX UI</h3><p>Built on our proprietary UI framework using Windows DWM API.</p></div>
             <div class="glass-card" data-aos="fade-up" data-aos-delay="300"><i class="fa-solid fa-chart-line" style="font-size:2rem; color:var(--accent); margin-bottom:15px;"></i><h3>Deep Analytics</h3><p>Track your productivity with interactive charts.</p></div>
             <div class="glass-card" data-aos="fade-up" data-aos-delay="400"><i class="fa-solid fa-calendar-check" style="font-size:2rem; color:var(--accent); margin-bottom:15px;"></i><h3>Auto-Pilot</h3><p>Schedule your day automatically.</p></div>
             <div class="glass-card" data-aos="fade-up" data-aos-delay="500"><i class="fa-solid fa-file-shield" style="font-size:2rem; color:var(--accent); margin-bottom:15px;"></i><h3>Task Intent</h3><p>Log exactly what you are working on before every session.</p></div>
        </div>
    </section>

    <!-- AMBIENT ENGINE -->
    <section class="section">
        <h2 style="text-align:center; margin-bottom:40px; font-size:2.5rem;">Ambient Engine</h2>
        <div class="grid-3">
            <div class="glass-card" onclick="toggleSound('jungle', this)" style="flex-direction:row; align-items:center; padding:20px; cursor:pointer; transition: all 0.3s ease;">
                <div class="icon-circle" style="background:var(--primary); width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; flex-shrink:0;"><i class="fa-solid fa-play" style="font-size:0.8rem; color:white;"></i></div>
                <div style="margin-left:15px;"><h4>Deep Jungle</h4></div>
                <div class="equalizer"><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>
                <audio id="jungle" src="../mixkit-rain-in-the-jungle-and-birds-2431.wav" loop></audio>
            </div>
             <div class="glass-card" onclick="toggleSound('rain', this)" style="flex-direction:row; align-items:center; padding:20px; cursor:pointer; transition: all 0.3s ease;">
                <div class="icon-circle" style="background:var(--primary); width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; flex-shrink:0;"><i class="fa-solid fa-play" style="font-size:0.8rem; color:white;"></i></div>
                <div style="margin-left:15px;"><h4>Heavy Rain</h4></div>
                <div class="equalizer"><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>
                <audio id="rain" src="../mixkit-heavy-rain-drops-2399.wav" loop></audio>
            </div>
             <div class="glass-card" onclick="toggleSound('thunder', this)" style="flex-direction:row; align-items:center; padding:20px; cursor:pointer; transition: all 0.3s ease;">
                <div class="icon-circle" style="background:var(--primary); width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; flex-shrink:0;"><i class="fa-solid fa-play" style="font-size:0.8rem; color:white;"></i></div>
                <div style="margin-left:15px;"><h4>Thunder</h4></div>
                <div class="equalizer"><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>
                <audio id="thunder" src="../mixkit-calm-thunderstorm-in-the-jungle-2415.wav" loop></audio>
            </div>
        </div>
    </section>

    <!-- DOWNLOAD SUCCESS OVERLAY -->
    <div id="download-overlay">
        <canvas id="confetti-canvas"></canvas>
        <div class="success-card">
            <div class="icon-wrapper">
                <div class="ripple"></div><div class="ripple"></div>
                <div class="success-circle"><i class="fa-solid fa-bolt"></i></div>
            </div>
            <h2 style="font-size:2rem; margin-bottom:10px;">Protocol <span class="text-grad">Initiated.</span></h2>
            <p style="color:#aaa; margin-bottom:30px;">Your download of FocusGuard Pro v12.0 has started.<br>Welcome to the top 1%.</p>
            <div style="display:flex; gap:15px; justify-content:center;">
                <button onclick="closeDownloadOverlay()" class="btn-glow" style="padding:10px 25px;">Back to Product</button>
                
                <!-- HOME BUTTON (No Transition for safety) -->
                <a href="../index.html" class="btn-glow no-transition" style="background:transparent; border:1px solid #333; box-shadow:none; text-decoration:none;">Home</a>
            </div>
            <p style="margin-top:20px; font-size:0.8rem; color:#666;">Download didn't start? <a href="#" id="retry-link" style="color:var(--accent);">Click here</a></p>
        </div>
    </div>

    <footer style="text-align:center; padding:50px; border-top:1px solid var(--glass-border); color:#666;">
        <p>Powered by <b>GravitonX Framework</b></p>
    </footer>

    <!-- SCRIPTS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js"></script>
    <!-- LINK TO MAIN SCRIPT -->
    <script src="../script.js"></script>
    
    <script>
        VanillaTilt.init(document.querySelector("img[data-tilt]"), { max: 15, speed: 400 });

        // --- FETCH GITHUB DOWNLOAD URL ---
        let downloadUrl = "";
        fetch('https://api.github.com/repos/MustafijRatul/FocusGuardRepo/releases/latest')
            .then(res => res.json())
            .then(data => {
                const asset = data.assets.find(a => a.name.endsWith('.exe'));
                if(asset) {
                    downloadUrl = asset.browser_download_url;
                    document.getElementById('retry-link').href = downloadUrl;
                }
            });

        // --- DOWNLOAD FLOW ---
        function startDownloadFlow() {
            if(!downloadUrl) { alert("Fetching latest version... please wait."); return; }
            
            // Trigger Download
            const link = document.createElement('a'); 
            link.href = downloadUrl; 
            link.setAttribute('download', '');
            document.body.appendChild(link); 
            link.click(); 
            document.body.removeChild(link);

            // Show Overlay
            const overlay = document.getElementById('download-overlay'); 
            overlay.classList.add('active');
            initConfetti();
        }

        function closeDownloadOverlay() { 
            document.getElementById('download-overlay').classList.remove('active'); 
        }

        // --- CONFETTI LOGIC ---
        function initConfetti() {
            const canvas = document.getElementById('confetti-canvas'); 
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; 
            canvas.height = window.innerHeight;
            
            let confetti = []; 
            const colors = ['#5D5FEF', '#FF4DFF', '#00D26A', '#ffffff'];

            for (let i = 0; i < 150; i++) {
                confetti.push({ 
                    x: canvas.width/2, y: canvas.height/2, 
                    w: Math.random()*8+4, h: Math.random()*8+4, 
                    color: colors[Math.floor(Math.random()*colors.length)], 
                    vx: (Math.random()-0.5)*20, vy: (Math.random()-0.5)*20, 
                    gravity: 0.15, rotation: Math.random()*360, 
                    rotationSpeed: (Math.random()-0.5)*0.2 
                });
            }
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height); 
                let active = false;
                confetti.forEach((c, i) => {
                    c.x += c.vx; c.y += c.vy; c.vy += c.gravity; 
                    c.rotation += c.rotationSpeed; c.w *= 0.96; c.h *= 0.96;
                    ctx.save(); ctx.translate(c.x, c.y); ctx.rotate(c.rotation); 
                    ctx.fillStyle = c.color; ctx.fillRect(-c.w/2, -c.h/2, c.w, c.h); 
                    ctx.restore();
                    if(c.w > 0.2 && c.y < canvas.height) active = true;
                });
                if(active && document.getElementById('download-overlay').classList.contains('active')) requestAnimationFrame(animate);
            }
            animate();
        }

        // --- TYPEWRITER ---
        new Typed('#fg-typewriter', {
            strings: ['Kill Distractions.', 'Boost Productivity.', 'Enter Flow State.', 'Block Games & Socials.'],
            typeSpeed: 60, backSpeed: 40, backDelay: 1500, loop: true, showCursor: false
        });

        // --- AUDIO PLAYER ---
        let currentAudio = null; let currentCard = null;
        function toggleSound(id, card) {
            const audio = document.getElementById(id); const icon = card.querySelector('i');
            if (currentAudio === audio && !audio.paused) { 
                audio.pause(); icon.classList.replace('fa-pause', 'fa-play'); 
                card.classList.remove('playing'); currentAudio = null; return; 
            }
            if (currentAudio) { 
                currentAudio.pause(); currentAudio.currentTime = 0; 
                currentCard.querySelector('i').classList.replace('fa-pause', 'fa-play'); 
                currentCard.classList.remove('playing'); 
            }
            audio.volume = 0.5; audio.play(); 
            icon.classList.replace('fa-play', 'fa-pause'); 
            card.classList.add('playing'); 
            currentAudio = audio; currentCard = card;
        }
    </script>
</body>
</html>
